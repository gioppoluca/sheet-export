
import baseMapping from "../../../../scripts/baseMapping.js";

class MappingClass extends baseMapping {


    authors = [
        {
            name: 'gioppoluca',
            url: 'https://github.com/gioppoluca',
            github: 'https://github.com/gioppoluca',
        },
    ];


    // override createMappings method from base class
    createMappings() {
        this.systemName = "CoC7";
        // Set the PDF files to use - MIND that the order of the files is important!
        this.pdfFiles.push({
            pdfUrl: '/modules/sheet-export/mappings/CoC7/CoC7 PC Sheet - Auto-Fill - 1920s - Standard - Color.pdf',
            nameDownload: `${this.actor.name ?? "character"}.pdf`,
            name: "CoC7 PC Sheet - Auto-Fill - 1920s - Standard - Color.pdf",
        });

        // Set Player image
        // in CoC7 pdf there is a white rectangle that stays above the image
        //    this.setImage(this.actor.img, 0, 420, 690, 70, 70);



        this.setCalculated("Investigators_Name", this.actor.name ?? '');
        this.setCalculated("Residence", this.actor.system.infos.residence ?? '');
        this.setCalculated("Age", this.actor.system.infos.age ?? '');
        this.setCalculated("Occupation", this.actor.occupation?.name ?? '');
        this.setCalculated("Birthplace", this.actor.system.infos.birthplace ?? '');
        this.setCalculated("Archetype", this.actor.archetype?.name ?? '');
        this.setCalculated("Pronouns", this.actor.system.infos.sex ?? '');
        this.setCalculated("STR", this.actor.system.characteristics.str.value ?? '');
        this.setCalculated("STR_half", Math.floor(this.actor.system.characteristics.str.value / 2) ?? '');
        this.setCalculated("STR_fifth", Math.floor(this.actor.system.characteristics.str.value / 5) ?? '');
        this.setCalculated("CON", this.actor.system.characteristics.con.value ?? '');
        this.setCalculated("CON_half", Math.floor(this.actor.system.characteristics.con.value / 2) ?? '');
        this.setCalculated("CON_fifth", Math.floor(this.actor.system.characteristics.con.value / 5) ?? '');
        this.setCalculated("DEX", this.actor.system.characteristics.dex.value ?? '');
        this.setCalculated("DEX_half", Math.floor(this.actor.system.characteristics.dex.value / 2) ?? '');
        this.setCalculated("DEX_fifth", Math.floor(this.actor.system.characteristics.dex.value / 5) ?? '');
        this.setCalculated("INT", this.actor.system.characteristics.int.value ?? '');
        this.setCalculated("INT_half", Math.floor(this.actor.system.characteristics.int.value / 2) ?? '');
        this.setCalculated("INT_fifth", Math.floor(this.actor.system.characteristics.int.value / 5) ?? '');
        this.setCalculated("SIZ", this.actor.system.characteristics.siz.value ?? '');
        this.setCalculated("SIZ_half", Math.floor(this.actor.system.characteristics.siz.value / 2) ?? '');
        this.setCalculated("SIZ_fifth", Math.floor(this.actor.system.characteristics.siz.value / 5) ?? '');
        this.setCalculated("POW", this.actor.system.characteristics.pow.value ?? '');
        this.setCalculated("POW_half", Math.floor(this.actor.system.characteristics.pow.value / 2) ?? '');
        this.setCalculated("POW_fifth", Math.floor(this.actor.system.characteristics.pow.value / 5) ?? '');
        this.setCalculated("APP", this.actor.system.characteristics.app.value ?? '');
        this.setCalculated("APP_half", Math.floor(this.actor.system.characteristics.app.value / 2) ?? '');
        this.setCalculated("APP_fifth", Math.floor(this.actor.system.characteristics.app.value / 5) ?? '');
        this.setCalculated("EDU", this.actor.system.characteristics.edu.value ?? '');
        this.setCalculated("EDU_half", Math.floor(this.actor.system.characteristics.edu.value / 2) ?? '');
        this.setCalculated("EDU_fifth", Math.floor(this.actor.system.characteristics.edu.value / 5) ?? '');
        this.setCalculated("StartingHP", this.actor.system.attribs.hp.max ?? '');
        this.setCalculated("CurrentHP", this.actor.system.attribs.hp.value ?? '');
        this.setCalculated("StartingMagic", this.actor.system.attribs.mp.max);
        this.setCalculated("CurrentMagic", this.actor.system.attribs.mp.value ?? '');
        this.setCalculated("StartingLuck", this.actor.system.attribs.lck.max);
        this.setCalculated("CurrentLuck", this.actor.system.attribs.lck.value ?? '');
        this.setCalculated("StartingSanity", this.actor.system.attribs.san.max);
        this.setCalculated("CurrentSanity", this.actor.system.attribs.san.value ?? '');
        this.setCalculated("MOV", this.actor.system.attribs.mov?.value ?? '');
        this.setCalculated("Build", this.actor.system.attribs.build.value ?? '');
        this.setCalculated("DamageBonus", this.actor.system.attribs.db.value ?? '');
        this.setCalculated("InsaneSanity", this.actor.dailySanLimit ?? '');
        this.setCalculated("MaxSanity", this.actor.sanMax ?? '');
        this.setCalculated("TempInsanity_Chk", this.actor.system.conditions.tempoInsane.value);
        this.setCalculated("IndefInsanity_Chk", this.actor.system.conditions.indefInsane.value);
        this.setCalculated("MajorWound_Chk", this.actor.system.conditions.criticalWounds.value);
        this.setCalculated("Unconscious_Chk", this.actor.system.conditions.unconscious.value);
        this.setCalculated("Dying_Chk", this.actor.system.conditions.dying.value);
        this.setCalculated("Skill_Accounting_Chk", this.actor.items.find(item => (item.name === 'Accounting' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.accounting') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Accounting", this.actor.items.find(item => (item.name === 'Accounting' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.accounting') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Accounting_half", (this.actor.items.find(item => (item.name === 'Accounting' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.accounting') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Accounting' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.accounting') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Accounting_fifth", (this.actor.items.find(item => (item.name === 'Accounting' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.accounting') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Accounting' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.accounting') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Appraise_Chk", this.actor.items.find(item => (item.name === 'Appraise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.appraise') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Appraise", this.actor.items.find(item => (item.name === 'Appraise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.appraise') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Appraise_half", (this.actor.items.find(item => (item.name === 'Appraise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.appraise') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Appraise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.appraise') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Appraise_fifth", (this.actor.items.find(item => (item.name === 'Appraise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.appraise') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Appraise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.appraise') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Archaeology_Chk", this.actor.items.find(item => (item.name === 'Archaeology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.archaeology') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Archaeology", this.actor.items.find(item => (item.name === 'Archaeology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.archaeology') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Archaeology_half", (this.actor.items.find(item => (item.name === 'Archaeology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.archaeology') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Archaeology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.archaeology') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Archaeology_fifth", (this.actor.items.find(item => (item.name === 'Archaeology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.archaeology') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Archaeology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.archaeology') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Anthropology_Chk", this.actor.items.find(item => (item.name === 'Anthropology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.anthropology') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Anthropology", this.actor.items.find(item => (item.name === 'Anthropology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.anthropology') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Anthropology_half", (this.actor.items.find(item => (item.name === 'Anthropology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.anthropology') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Anthropology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.anthropology') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Anthropology_fifth", (this.actor.items.find(item => (item.name === 'Anthropology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.anthropology') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Anthropology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.anthropology') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_ArtCraft1_Chk", this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.system.flags?.developement ?? false);
        this.setCalculated("Skill_ArtCraft1", this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '');
        this.setCalculated("SkillDef_ArtCraft1", this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.name ?? '');
        this.setCalculated("Skill_ArtCraft1_half", (this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 2));
        this.setCalculated("Skill_ArtCraft1_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 5));
        this.setCalculated("Skill_ArtCraft2_Chk", this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.system.flags?.developement ?? false);
        this.setCalculated("Skill_ArtCraft2", this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '');
        this.setCalculated("SkillDef_ArtCraft2", this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.name ?? '');
        this.setCalculated("Skill_ArtCraft2_half", (this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value / 2));
        this.setCalculated("Skill_ArtCraft2_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Art/Craft' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.art-craft-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value / 5));
        this.setCalculated("Skill_Charm_Chk", this.actor.items.find(item => (item.name === 'Charm' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.charm') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Charm", this.actor.items.find(item => (item.name === 'Charm' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.charm') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Charm_half", (this.actor.items.find(item => (item.name === 'Charm' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.charm') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Charm' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.charm') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Charm_fifth", (this.actor.items.find(item => (item.name === 'Charm' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.charm') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Charm' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.charm') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Climb_Chk", this.actor.items.find(item => (item.name === 'Climb' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.climb') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Climb", this.actor.items.find(item => (item.name === 'Climb' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.climb') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Climb_half", (this.actor.items.find(item => (item.name === 'Climb' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.climb') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Climb' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.climb') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Climb_fifth", (this.actor.items.find(item => (item.name === 'Climb' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.climb') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Climb' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.climb') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Computer_Chk", this.actor.items.find(item => (item.name === 'Computer Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.computer-use') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Computer", this.actor.items.find(item => (item.name === 'Computer Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.computer-use') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Computer_half", (this.actor.items.find(item => (item.name === 'Computer Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.computer-use') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Computer Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.computer-use') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Computer_fifth", (this.actor.items.find(item => (item.name === 'Computer Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.computer-use') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Computer Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.computer-use') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Credit", this.actor.items.find(item => (item.name === 'Credit Rating' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.credit-rating') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Credit_half", (this.actor.items.find(item => (item.name === 'Credit Rating' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.credit-rating') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Credit Rating' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.credit-rating') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Credit_fifth", (this.actor.items.find(item => (item.name === 'Credit Rating' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.credit-rating') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Credit Rating' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.credit-rating') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Cthulhu", this.actor.items.find(item => (item.name === 'Cthulhu Mythos' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.cthulhu-mythos') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Cthulhu_half", (this.actor.items.find(item => (item.name === 'Cthulhu Mythos' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.cthulhu-mythos') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Cthulhu Mythos' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.cthulhu-mythos') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Cthulhu_fifth", (this.actor.items.find(item => (item.name === 'Cthulhu Mythos' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.cthulhu-mythos') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Cthulhu Mythos' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.cthulhu-mythos') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Demo_Chk", this.actor.items.find(item => (item.name === 'Demolitions' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.demolitions') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Demo", this.actor.items.find(item => (item.name === 'Demolitions' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.demolitions') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Demo_half", (this.actor.items.find(item => (item.name === 'Demolitions' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.demolitions') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Demolitions' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.demolitions') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Demo_fifth", (this.actor.items.find(item => (item.name === 'Demolitions' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.demolitions') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Demolitions' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.demolitions') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Disguise_Chk", this.actor.items.find(item => (item.name === 'Disguise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.disguise') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Disguise", this.actor.items.find(item => (item.name === 'Disguise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.disguise') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Disguise_half", (this.actor.items.find(item => (item.name === 'Disguise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.disguise') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Disguise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.disguise') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Disguise_fifth", (this.actor.items.find(item => (item.name === 'Disguise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.disguise') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Disguise' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.disguise') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Diving_Chk", this.actor.items.find(item => (item.name === 'Diving' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.diving') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Diving", this.actor.items.find(item => (item.name === 'Diving' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.diving') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Diving_half", (this.actor.items.find(item => (item.name === 'Diving' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.diving') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Diving' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.diving') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Diving_fifth", (this.actor.items.find(item => (item.name === 'Diving' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.diving') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Diving' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.diving') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Dodge_Chk", this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Dodge", this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Dodge_half", (this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Dodge_fifth", (this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value / 5));
        this.setCalculated("Dodge_Copy_Chk", this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Dodge_Copy", this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Dodge_Copy_half", (this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value / 2));
        this.setCalculated("Dodge_Copy_fifth", (this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Dodge' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.dodge') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Drive_Chk", this.actor.items.find(item => (item.name === 'Drive Auto' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.drive-auto') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Drive", this.actor.items.find(item => (item.name === 'Drive Auto' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.drive-auto') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Drive_half", (this.actor.items.find(item => (item.name === 'Drive Auto' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.drive-auto') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Drive Auto' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.drive-auto') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Drive_fifth", (this.actor.items.find(item => (item.name === 'Drive Auto' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.drive-auto') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Drive Auto' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.drive-auto') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_ElecRepair_Chk", this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_ElecRepair", this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_ElecRepair_half", (this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_ElecRepair_fifth", (this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Elec_Chk", this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Elec", this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Elec_half", (this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Elec_fifth", (this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Electrical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.electrical-repair') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_FastTalk_Chk", this.actor.items.find(item => (item.name === 'Fast Talk' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fast-talk') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_FastTalk", this.actor.items.find(item => (item.name === 'Fast Talk' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fast-talk') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_FastTalk_half", (this.actor.items.find(item => (item.name === 'Fast Talk' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fast-talk') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Fast Talk' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fast-talk') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_FastTalk_fifth", (this.actor.items.find(item => (item.name === 'Fast Talk' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fast-talk') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Fast Talk' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fast-talk') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Fighting_Chk", this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Fighting", this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Fighting_half", (this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Fighting_fifth", (this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Fighting1_Chk", this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_Fighting1", this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.name ?? '');
        this.setCalculated("Skill_Fighting1", this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '');
        this.setCalculated("Skill_Fighting1_half", (this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 2));
        this.setCalculated("Skill_Fighting1_fifth", (this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 5));
        this.setCalculated("Skill_Fighting2_Chk", this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_Fighting2", this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.name ?? '');
        this.setCalculated("Skill_Fighting2", this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '');
        this.setCalculated("Skill_Fighting2_half", (this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value / 2));
        this.setCalculated("Skill_Fighting2_fifth", (this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => ((item.system.specialization === 'Fighting' && !['Brawl', 'Throw'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.fighting-/) && !['i.skill.fighting-brawl', 'i.skill.fighting-throw'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value / 5));
        this.setCalculated("Skill_FireArmsHandguns_Chk", this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_FireArmsHandguns", this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_FireArmsHandguns_half", (this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_FireArmsHandguns_fifth", (this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_FirearmsHandguns_Chk", this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_FirearmsHandguns", this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_FirearmsHandguns_half", (this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_FirearmsHandguns_fifth", (this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Firearms (Handgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-handgun') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_FireArmsRifles_Chk", this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_FireArmsRifles", this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_FireArmsRifles_half", (this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_FireArmsRifles_fifth", (this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_FirearmsRifles_Chk", this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_FirearmsRifles", this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_FirearmsRifles_half", (this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_FirearmsRifles_fifth", (this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Firearms (Rifle/Shotgun)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.firearms-rifle-shotgun') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Firearms_Chk", this.actor.items.filter(item => ((item.system.specialization === 'Firearms' && !['Rifle/Shotgun', 'Handgun'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.firearms-/) && !['i.skill.firearms-rifle-shotgun', 'i.skill.firearms-handgun'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_Firearms", this.actor.items.filter(item => ((item.system.specialization === 'Firearms' && !['Rifle/Shotgun', 'Handgun'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.firearms-/) && !['i.skill.firearms-rifle-shotgun', 'i.skill.firearms-handgun'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.name ?? '');
        this.setCalculated("Skill_Firearms", this.actor.items.filter(item => ((item.system.specialization === 'Firearms' && !['Rifle/Shotgun', 'Handgun'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.firearms-/) && !['i.skill.firearms-rifle-shotgun', 'i.skill.firearms-handgun'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '');
        this.setCalculated("Skill_Firearms_half", (this.actor.items.filter(item => ((item.system.specialization === 'Firearms' && !['Rifle/Shotgun', 'Handgun'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.firearms-/) && !['i.skill.firearms-rifle-shotgun', 'i.skill.firearms-handgun'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => ((item.system.specialization === 'Firearms' && !['Rifle/Shotgun', 'Handgun'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.firearms-/) && !['i.skill.firearms-rifle-shotgun', 'i.skill.firearms-handgun'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 2));
        this.setCalculated("Skill_Firearms_fifth", (this.actor.items.filter(item => ((item.system.specialization === 'Firearms' && !['Rifle/Shotgun', 'Handgun'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.firearms-/) && !['i.skill.firearms-rifle-shotgun', 'i.skill.firearms-handgun'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => ((item.system.specialization === 'Firearms' && !['Rifle/Shotgun', 'Handgun'].includes(item.system.skillName)) || (item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.firearms-/) && !['i.skill.firearms-rifle-shotgun', 'i.skill.firearms-handgun'].includes(item.flags?.CoC7?.cocidFlag?.id))) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 5));
        this.setCalculated("Skill_FirstAid_Chk", this.actor.items.find(item => (item.name === 'First Aid' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.first-aid') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_FirstAid", this.actor.items.find(item => (item.name === 'First Aid' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.first-aid') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_FirstAid_half", (this.actor.items.find(item => (item.name === 'First Aid' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.first-aid') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'First Aid' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.first-aid') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_FirstAid_fifth", (this.actor.items.find(item => (item.name === 'First Aid' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.first-aid') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'First Aid' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.first-aid') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_History_Chk", this.actor.items.find(item => (item.name === 'History' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.history') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_History", this.actor.items.find(item => (item.name === 'History' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.history') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_History_half", (this.actor.items.find(item => (item.name === 'History' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.history') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'History' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.history') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_History_fifth", (this.actor.items.find(item => (item.name === 'History' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.history') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'History' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.history') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Intimidate_Chk", this.actor.items.find(item => (item.name === 'Intimidate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.intimidate') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Intimidate", this.actor.items.find(item => (item.name === 'Intimidate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.intimidate') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Intimidate_half", (this.actor.items.find(item => (item.name === 'Intimidate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.intimidate') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Intimidate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.intimidate') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Intimidate_fifth", (this.actor.items.find(item => (item.name === 'Intimidate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.intimidate') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Intimidate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.intimidate') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Jump_Chk", this.actor.items.find(item => (item.name === 'Jump' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.jump') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Jump", this.actor.items.find(item => (item.name === 'Jump' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.jump') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Jump_half", (this.actor.items.find(item => (item.name === 'Jump' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.jump') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Jump' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.jump') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Jump_fifth", (this.actor.items.find(item => (item.name === 'Jump' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.jump') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Jump' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.jump') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_OwnLanguage_Chk", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_OwnLanguage", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.name ?? '');
        this.setCalculated("Skill_OwnLanguage", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '');
        this.setCalculated("Skill_OwnLanguage_half", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 2));
        this.setCalculated("Skill_OwnLanguage_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 5));
        this.setCalculated("Skill_OtherLanguage_Chk", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_OtherLanguage", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.name ?? '');
        this.setCalculated("Skill_OtherLanguage", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '');
        this.setCalculated("Skill_OtherLanguage_half", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value / 2));
        this.setCalculated("Skill_OtherLanguage_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value / 5));
        this.setCalculated("Skill_OtherLanguage1_Chk", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_OtherLanguage1", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.name ?? '');
        this.setCalculated("Skill_OtherLanguage1", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value ?? '');
        this.setCalculated("Skill_OtherLanguage1_half", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value / 2));
        this.setCalculated("Skill_OtherLanguage1_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value / 5));
        this.setCalculated("Skill_OtherLanguage2_Chk", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[3]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_OtherLanguage2", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[3]?.name ?? '');
        this.setCalculated("Skill_OtherLanguage2", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[3]?.value ?? '');
        this.setCalculated("Skill_OtherLanguage2_half", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[3]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[3]?.value / 2));
        this.setCalculated("Skill_OtherLanguage2_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[3]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[3]?.value / 5));
        this.setCalculated("Skill_OtherLanguage3_Chk", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[4]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_OtherLanguage3", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[4]?.name ?? '');
        this.setCalculated("Skill_OtherLanguage3", this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[4]?.value ?? '');
        this.setCalculated("Skill_OtherLanguage3_half", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[4]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[4]?.value / 2));
        this.setCalculated("Skill_OtherLanguage3_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[4]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Language' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.language-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[4]?.value / 5));
        this.setCalculated("Skill_Law_Chk", this.actor.items.find(item => (item.name === 'Law' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.law') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Law", this.actor.items.find(item => (item.name === 'Law' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.law') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Law_half", (this.actor.items.find(item => (item.name === 'Law' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.law') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Law' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.law') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Law_fifth", (this.actor.items.find(item => (item.name === 'Law' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.law') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Law' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.law') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_LibraryUse_Chk", this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_LibraryUse", this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_LibraryUse_half", (this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_LibraryUse_fifth", (this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Library_Chk", this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Library", this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Library_half", (this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Library_fifth", (this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Library Use' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.library-use') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Listen_Chk", this.actor.items.find(item => (item.name === 'Listen' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.listen') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Listen", this.actor.items.find(item => (item.name === 'Listen' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.listen') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Listen_half", (this.actor.items.find(item => (item.name === 'Listen' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.listen') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Listen' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.listen') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Listen_fifth", (this.actor.items.find(item => (item.name === 'Listen' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.listen') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Listen' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.listen') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Locksmith_Chk", this.actor.items.find(item => (item.name === 'Locksmith' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.locksmith') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Locksmith", this.actor.items.find(item => (item.name === 'Locksmith' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.locksmith') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Locksmith_half", (this.actor.items.find(item => (item.name === 'Locksmith' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.locksmith') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Locksmith' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.locksmith') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Locksmith_fifth", (this.actor.items.find(item => (item.name === 'Locksmith' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.locksmith') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Locksmith' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.locksmith') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_MechRepair_Chk", this.actor.items.find(item => (item.name === 'Mechanical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.mechanical-repair') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_MechRepair", this.actor.items.find(item => (item.name === 'Mechanical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.mechanical-repair') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_MechRepair_half", (this.actor.items.find(item => (item.name === 'Mechanical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.mechanical-repair') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Mechanical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.mechanical-repair') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_MechRepair_fifth", (this.actor.items.find(item => (item.name === 'Mechanical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.mechanical-repair') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Mechanical Repair' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.mechanical-repair') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Medicine_Chk", this.actor.items.find(item => (item.name === 'Medicine' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.medicine') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Medicine", this.actor.items.find(item => (item.name === 'Medicine' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.medicine') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Medicine_half", (this.actor.items.find(item => (item.name === 'Medicine' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.medicine') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Medicine' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.medicine') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Medicine_fifth", (this.actor.items.find(item => (item.name === 'Medicine' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.medicine') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Medicine' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.medicine') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_NaturalWorld_Chk", this.actor.items.find(item => (item.name === 'Natural World' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.natural-world') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_NaturalWorld", this.actor.items.find(item => (item.name === 'Natural World' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.natural-world') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_NaturalWorld_half", (this.actor.items.find(item => (item.name === 'Natural World' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.natural-world') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Natural World' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.natural-world') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_NaturalWorld_fifth", (this.actor.items.find(item => (item.name === 'Natural World' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.natural-world') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Natural World' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.natural-world') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Navigate_Chk", this.actor.items.find(item => (item.name === 'Navigate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.navigate') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Navigate", this.actor.items.find(item => (item.name === 'Navigate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.navigate') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Navigate_half", (this.actor.items.find(item => (item.name === 'Navigate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.navigate') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Navigate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.navigate') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Navigate_fifth", (this.actor.items.find(item => (item.name === 'Navigate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.navigate') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Navigate' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.navigate') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Occult_Chk", this.actor.items.find(item => (item.name === 'Occult' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.occult') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Occult", this.actor.items.find(item => (item.name === 'Occult' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.occult') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Occult_half", (this.actor.items.find(item => (item.name === 'Occult' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.occult') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Occult' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.occult') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Occult_fifth", (this.actor.items.find(item => (item.name === 'Occult' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.occult') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Occult' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.occult') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Persuade_Chk", this.actor.items.find(item => (item.name === 'Persuade' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.persuade') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Persuade", this.actor.items.find(item => (item.name === 'Persuade' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.persuade') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Persuade_half", (this.actor.items.find(item => (item.name === 'Persuade' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.persuade') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Persuade' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.persuade') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Persuade_fifth", (this.actor.items.find(item => (item.name === 'Persuade' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.persuade') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Persuade' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.persuade') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Pilot_Chk", this.actor.items.filter(item => (item.system.specialization === 'Pilot' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.pilot-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_Pilot", this.actor.items.filter(item => (item.system.specialization === 'Pilot' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.pilot-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.name ?? '');
        this.setCalculated("Skill_Pilot", this.actor.items.filter(item => (item.system.specialization === 'Pilot' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.pilot-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '');
        this.setCalculated("Skill_Pilot_half", (this.actor.items.filter(item => (item.system.specialization === 'Pilot' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.pilot-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Pilot' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.pilot-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 2));
        this.setCalculated("Skill_Pilot_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Pilot' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.pilot-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Pilot' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.pilot-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 5));
        this.setCalculated("Skill_Psychoanalysis_Chk", this.actor.items.find(item => (item.name === 'Psychoanalysis' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychoanalysis') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Psychoanalysis", this.actor.items.find(item => (item.name === 'Psychoanalysis' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychoanalysis') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Psychoanalysis_half", (this.actor.items.find(item => (item.name === 'Psychoanalysis' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychoanalysis') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Psychoanalysis' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychoanalysis') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Psychoanalysis_fifth", (this.actor.items.find(item => (item.name === 'Psychoanalysis' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychoanalysis') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Psychoanalysis' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychoanalysis') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Psychology_Chk", this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Psychology", this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Psychology_half", (this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Psychology_fifth", (this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Psyschology_Chk", this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Psyschology", this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Psyschology_half", (this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Psyschology_fifth", (this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Psychology' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.psychology') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_ReadLips_Chk", this.actor.items.find(item => (item.name === 'Read Lips' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.read-lips') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_ReadLips", this.actor.items.find(item => (item.name === 'Read Lips' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.read-lips') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_ReadLips_half", (this.actor.items.find(item => (item.name === 'Read Lips' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.read-lips') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Read Lips' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.read-lips') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_ReadLips_fifth", (this.actor.items.find(item => (item.name === 'Read Lips' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.read-lips') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Read Lips' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.read-lips') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Ride_Chk", this.actor.items.find(item => (item.name === 'Ride' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.ride') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Ride", this.actor.items.find(item => (item.name === 'Ride' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.ride') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Ride_half", (this.actor.items.find(item => (item.name === 'Ride' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.ride') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Ride' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.ride') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Ride_fifth", (this.actor.items.find(item => (item.name === 'Ride' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.ride') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Ride' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.ride') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Science1_Chk", this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_Science1", this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.name ?? '');
        this.setCalculated("Skill_Science1", this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '');
        this.setCalculated("Skill_Science1_half", (this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 2));
        this.setCalculated("Skill_Science1_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 5));
        this.setCalculated("Skill_Science2_Chk", this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_Science2", this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.name ?? '');
        this.setCalculated("Skill_Science2", this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '');
        this.setCalculated("Skill_Science2_half", (this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value / 2));
        this.setCalculated("Skill_Science2_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[1]?.value / 5));
        this.setCalculated("Skill_Science3_Chk", this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_Science3", this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.name ?? '');
        this.setCalculated("Skill_Science3", this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value ?? '');
        this.setCalculated("Skill_Science3_half", (this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value / 2));
        this.setCalculated("Skill_Science3_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Science' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.science-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[2]?.value / 5));
        this.setCalculated("Skill_Sleight_Chk", this.actor.items.find(item => (item.name === 'Sleight of Hand' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.sleight-of-hand') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Sleight", this.actor.items.find(item => (item.name === 'Sleight of Hand' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.sleight-of-hand') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Sleight_half", (this.actor.items.find(item => (item.name === 'Sleight of Hand' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.sleight-of-hand') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Sleight of Hand' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.sleight-of-hand') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Sleight_fifth", (this.actor.items.find(item => (item.name === 'Sleight of Hand' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.sleight-of-hand') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Sleight of Hand' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.sleight-of-hand') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_SpotHidden_Chk", this.actor.items.find(item => (item.name === 'Spot Hidden' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.spot-hidden') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_SpotHidden", this.actor.items.find(item => (item.name === 'Spot Hidden' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.spot-hidden') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_SpotHidden_half", (this.actor.items.find(item => (item.name === 'Spot Hidden' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.spot-hidden') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Spot Hidden' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.spot-hidden') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_SpotHidden_fifth", (this.actor.items.find(item => (item.name === 'Spot Hidden' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.spot-hidden') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Spot Hidden' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.spot-hidden') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Stealth_Chk", this.actor.items.find(item => (item.name === 'Stealth' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.stealth') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Stealth", this.actor.items.find(item => (item.name === 'Stealth' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.stealth') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Stealth_half", (this.actor.items.find(item => (item.name === 'Stealth' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.stealth') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Stealth' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.stealth') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Stealth_fifth", (this.actor.items.find(item => (item.name === 'Stealth' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.stealth') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Stealth' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.stealth') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Survival_Chk", this.actor.items.filter(item => (item.system.specialization === 'Survival' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.survival-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.system.flags?.developement ?? false);
        this.setCalculated("SkillDef_Survival", this.actor.items.filter(item => (item.system.specialization === 'Survival' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.survival-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.name ?? '');
        this.setCalculated("Skill_Survival", this.actor.items.filter(item => (item.system.specialization === 'Survival' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.survival-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '');
        this.setCalculated("Skill_Survival_half", (this.actor.items.filter(item => (item.system.specialization === 'Survival' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.survival-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Survival' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.survival-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 2));
        this.setCalculated("Skill_Survival_fifth", (this.actor.items.filter(item => (item.system.specialization === 'Survival' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.survival-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => (item.system.specialization === 'Survival' || item.flags?.CoC7?.cocidFlag?.id.match(/^i.skill.survival-/)) && item.type === 'skill').sort((a, b) => b.value - a.value)[0]?.value / 5));
        this.setCalculated("Skill_Swim_Chk", this.actor.items.find(item => (item.name === 'Swim' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.swim') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Swim", this.actor.items.find(item => (item.name === 'Swim' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.swim') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Swim_half", (this.actor.items.find(item => (item.name === 'Swim' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.swim') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Swim' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.swim') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Swim_fifth", (this.actor.items.find(item => (item.name === 'Swim' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.swim') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Swim' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.swim') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Throw_Chk", this.actor.items.find(item => (item.name === 'Fighting (Throw)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-throw') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Throw", this.actor.items.find(item => (item.name === 'Fighting (Throw)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-throw') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Throw_half", (this.actor.items.find(item => (item.name === 'Fighting (Throw)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-throw') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Fighting (Throw)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-throw') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Throw_fifth", (this.actor.items.find(item => (item.name === 'Fighting (Throw)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-throw') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Fighting (Throw)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-throw') && item.type === 'skill')?.value / 5));
        this.setCalculated("Skill_Track_Chk", this.actor.items.find(item => (item.name === 'Track' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.track') && item.type === 'skill')?.system.flags?.developement ?? false);
        this.setCalculated("Skill_Track", this.actor.items.find(item => (item.name === 'Track' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.track') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Skill_Track_half", (this.actor.items.find(item => (item.name === 'Track' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.track') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Track' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.track') && item.type === 'skill')?.value / 2));
        this.setCalculated("Skill_Track_fifth", (this.actor.items.find(item => (item.name === 'Track' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.track') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Track' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.track') && item.type === 'skill')?.value / 5));
        this.setCalculated("Weapon_Regular0", this.actor.items.filter(item => item.type === 'weapon').length == 0 ? "" : this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value ?? '');
        this.setCalculated("Weapon_Hard0", (this.actor.items.filter(item => item.type === 'weapon').length == 0 ? "" : this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value / 2));
        this.setCalculated("Weapon_Extreme0", (this.actor.items.filter(item => item.type === 'weapon').length == 0 ? "" : this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value ?? '') === '' ? '' : Math.floor(this.actor.items.find(item => (item.name === 'Fighting (Brawl)' || item.flags?.CoC7?.cocidFlag?.id === 'i.skill.fighting-brawl') && item.type === 'skill')?.value / 5));
        this.setCalculated("Weapon_Name1", this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0]?.name ?? '');
        this.setCalculated("Weapon_Regular1", this.actor.items.filter(item => item.type === 'weapon').length <= 1 ? "" : this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0]?.system.skill.main ?? ''))?.skill?.value ?? '');
        this.setCalculated("Weapon_Hard1", (this.actor.items.filter(item => item.type === 'weapon').length <= 1 ? "" : this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0].system.skill.main)).skill?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0].system.skill.main)).skill?.value / 2));
        this.setCalculated("Weapon_Extreme1", (this.actor.items.filter(item => item.type === 'weapon').length <= 1 ? "" : this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0].system.skill.main)).skill?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0].system.skill.main)).skill?.value / 5));
        this.setCalculated("Weapon_Damage1", ((this.actor.items.filter(item => item.type === 'weapon').length <= 1 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0]?.system.range?.normal?.damage ?? '') + ' ' + ((this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0]?.system.properties?.addb ?? false) ? '+DB' : '') + ' ' + ((this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0]?.system.properties?.ahdb ?? false) ? '+DB/2' : '')).trim());
        this.setCalculated("Weapon_Attacks1", this.actor.items.filter(item => item.type === 'weapon').length <= 1 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0]?.system.usesPerRound?.normal ?? '');
        this.setCalculated("Weapon_Range1", this.actor.items.filter(item => item.type === 'weapon').length <= 1 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0].system.range?.normal?.value ?? '');
        this.setCalculated("Weapon_Ammo1", this.actor.items.filter(item => item.type === 'weapon').length <= 1 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0].system.bullets ?? '');
        this.setCalculated("Weapon_Malf1", this.actor.items.filter(item => item.type === 'weapon').length <= 1 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[0].system.malfunction ?? '');
        this.setCalculated("Weapon_Name2", this.actor.items.filter(item => item.type === 'weapon').length <= 2 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1]?.name ?? '');
        this.setCalculated("Weapon_Regular2", this.actor.items.filter(item => item.type === 'weapon').length <= 2 ? "" : this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1].system.skill.main)).skill?.value ?? '');
        this.setCalculated("Weapon_Hard2", (this.actor.items.filter(item => item.type === 'weapon').length <= 2 ? "" : this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1].system.skill.main)).skill?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1].system.skill.main)).skill?.value / 2));
        this.setCalculated("Weapon_Extreme2", (this.actor.items.filter(item => item.type === 'weapon').length <= 2 ? "" : this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1].system.skill.main)).skill?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1].system.skill.main)).skill?.value / 5));
        this.setCalculated("Weapon_Damage2", ((this.actor.items.filter(item => item.type === 'weapon').length <= 2 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1]?.system.range?.normal?.damage ?? '') + ' ' + ((this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1]?.system.properties?.addb ?? false) ? '+DB' : '') + ' ' + ((this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1]?.system.properties?.ahdb ?? false) ? '+DB/2' : '')).trim());
        this.setCalculated("Weapon_Attacks2", this.actor.items.filter(item => item.type === 'weapon').length <= 2 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1]?.system.usesPerRound?.normal ?? '');
        this.setCalculated("Weapon_Range2", this.actor.items.filter(item => item.type === 'weapon').length <= 2 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1].system.range?.normal?.value ?? '');
        this.setCalculated("Weapon_Ammo2", this.actor.items.filter(item => item.type === 'weapon').length <= 2 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1].system.bullets ?? '');
        this.setCalculated("Weapon_Malf2", this.actor.items.filter(item => item.type === 'weapon').length <= 2 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[1].system.malfunction ?? '');
        this.setCalculated("Weapon_Name3", this.actor.items.filter(item => item.type === 'weapon').length <= 3 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2]?.name ?? '');
        this.setCalculated("Weapon_Regular3", this.actor.items.filter(item => item.type === 'weapon').length <= 3 ? "" : this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2].system.skill.main)).skill?.value ?? '');
        this.setCalculated("Weapon_Hard3", (this.actor.items.filter(item => item.type === 'weapon').length <= 3 ? "" : this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2].system.skill.main)).skill?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2].system.skill.main)).skill?.value / 2));
        this.setCalculated("Weapon_Extreme3", (this.actor.items.filter(item => item.type === 'weapon').length <= 3 ? "" : this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2].system.skill.main)).skill?.value ?? '') === '' ? '' : Math.floor(this.actor.items.filter(item => item.type === 'skill').reduce((c, d) => { if (d.name === c.name || d.id === c.id) { c.skill = d; } return c }, duplicate(this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2].system.skill.main)).skill?.value / 5));
        this.setCalculated("Weapon_Damage3", ((this.actor.items.filter(item => item.type === 'weapon').length <= 3 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2]?.system.range?.normal?.damage ?? '') + ' ' + ((this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2]?.system.properties?.addb ?? false) ? '+DB' : '') + ' ' + ((this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2]?.system.properties?.ahdb ?? false) ? '+DB/2' : '')).trim());
        this.setCalculated("Weapon_Attacks3", this.actor.items.filter(item => item.type === 'weapon').length <= 3 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2]?.system.usesPerRound?.normal ?? '');
        this.setCalculated("Weapon_Range3", this.actor.items.filter(item => item.type === 'weapon').length <= 3 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2].system.range?.normal?.value ?? '');
        this.setCalculated("Weapon_Ammo3", this.actor.items.filter(item => item.type === 'weapon').length <= 3 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2].system.bullets ?? '');
        this.setCalculated("Weapon_Malf3", this.actor.items.filter(item => item.type === 'weapon').length <= 3 ? "" : this.actor.items.filter(item => item.type === 'weapon' && !['Brawl', 'Punch'].includes(item.name) && !item.flags?.CoC7?.cocidFlag?.id.match(/^i\.weapon\.(punch|brawl)$/))[2].system.malfunction ?? '');
        this.setCalculated("SpendingLevel", (this.actor.system.flags.manualCredit ? this.actor.system.monetary.spendingLevel : CONFIG.Actor.documentClass.monetaryFormat(this.actor.system.monetary.format, this.actor.system.monetary.symbol, this.actor.spendingLevel)));
        this.setCalculated("Cash", (this.actor.system.flags.manualCredit ? this.actor.system.monetary.cash : CONFIG.Actor.documentClass.monetaryFormat(this.actor.system.monetary.format, this.actor.system.monetary.symbol, this.actor.cash)));
        this.setCalculated("Assets1", (this.actor.system.flags.manualCredit ? this.actor.system.monetary.assets : CONFIG.Actor.documentClass.monetaryFormat(this.actor.system.monetary.format, this.actor.system.monetary.symbol, this.actor.assets)));
        this.setCalculated("PersonalDescription", this.actor.system.biography[0]?.value ?? '');
        this.setCalculated("Ideology/Beliefs", this.actor.system.biography[1]?.value ?? '');
        this.setCalculated("Significant People", this.actor.system.biography[2]?.value ?? '');
        this.setCalculated("Locations", this.actor.system.biography[3]?.value ?? '');
        this.setCalculated("Possessions", this.actor.system.biography[4]?.value ?? '');
        this.setCalculated("Phobias/Manias", this.actor.system.biography[5]?.value ?? '');
        this.setCalculated("Traits", this.actor.system.biography[6]?.value ?? '');
        this.setCalculated("Injuries", this.actor.system.biography[7]?.value ?? '');
        this.setCalculated("Encounters", this.actor.system.biography[8]?.value ?? '');
        this.setCalculated("Gear/Possessions", (this.actor.items.filter(item => item.type === "item")[0]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "item")[1]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "item")[2]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "item")[3]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "item")[4]?.name ?? ''));
        this.setCalculated("Gear/Possessions1", (this.actor.items.filter(item => item.type === "item")[5]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "item")[6]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "item")[7]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "item")[8]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "item")[9]?.name ?? ''));
        this.setCalculated("Tomes/Spells", (this.actor.items.filter(item => item.type === "book")[0]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "book")[1]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "book")[2]?.name ?? ''));
        this.setCalculated("Pulp Talents", (this.actor.items.filter(item => item.type === "talent")[0]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "talent")[1]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "talent")[2]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "talent")[3]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "talent")[4]?.name ?? '') + "\n" +
            (this.actor.items.filter(item => item.type === "talent")[5]?.name ?? ''));
    }
}

export default MappingClass;
